<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Frontend Documentation</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: volume/pivot.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// Generated by CoffeeScript 1.12.7

/**
 * Spreadsheet pivot
 * @module
 */
'use strict';
app.directive('volumePivot', [
  'constantService', 'displayService', function(constants, display) {
    return {
      restrict: 'E',
      link: function($scope, $element) {
        var pivot;
        pivot = $scope.pivot;
        pivot.run = function(rows, opts) {
          var a, agediv, agemode, cols, d, data, disp, g, head, i, j, l, len, len1, len2, len3, len4, len5, len6, m, n, o, p, q, r, ref, ref1, ref2, ref3, row, s, t, u;
          cols = $scope.groups;
          head = [];
          for (j = 0, len = cols.length; j &lt; len; j++) {
            g = cols[j];
            if (!(g.category.id !== 'asset')) {
              continue;
            }
            if (g.category.id === 'slot') {
              n = '';
            } else {
              n = g.category.name + ' ';
            }
            ref = g.metrics;
            for (o = 0, len1 = ref.length; o &lt; len1; o++) {
              m = ref[o];
              if (m.id !== 'summary') {
                if (m.id === 'age') {
                  agemode = display.ageMode($scope.volume.summary.agemean);
                  head.push(n + m.name + ' (' + agemode + 's)');
                  agediv = constants.age[agemode];
                } else {
                  head.push(n + m.name);
                }
              }
            }
          }
          data = [head];
          disp = function(m, v) {
            if (v == null) {
              if (m.assumed) {
                return '\u2043default\u2043 (' + m.assumed + ')';
              } else {
                return '';
              }
            }
            switch (m.id) {
              case 'release':
                return constants.release[v];
              case 'age':
                return v / agediv;
              case 'top':
                if (v === 'global') {
                  return 'volume';
                } else {
                  return m.options[v];
                }
                break;
              default:
                if (m.type === 'void') {
                  return true;
                } else {
                  return v;
                }
            }
          };
          for (p = 0, len2 = rows.length; p &lt; len2; p++) {
            row = rows[p];
            if (!((row != null ? row.filt : void 0) &amp;&amp; row.key)) {
              continue;
            }
            data.push(d = []);
            for (q = 0, len3 = cols.length; q &lt; len3; q++) {
              g = cols[q];
              if (!(g.category.id !== 'asset')) {
                continue;
              }
              l = row.list(g.category.id);
              switch (l.length) {
                case 0:
                  ref1 = g.metrics;
                  for (s = 0, len4 = ref1.length; s &lt; len4; s++) {
                    m = ref1[s];
                    if (m.id !== 'summary') {
                      d.push('\u2043none\u2043');
                    }
                  }
                  break;
                case 1:
                  r = l[0];
                  ref2 = g.metrics;
                  for (t = 0, len5 = ref2.length; t &lt; len5; t++) {
                    m = ref2[t];
                    if (m.id !== 'summary') {
                      d.push(disp(m, r[m.id]));
                    }
                  }
                  break;
                default:
                  ref3 = g.metrics;
                  for (u = 0, len6 = ref3.length; u &lt; len6; u++) {
                    m = ref3[u];
                    if (!(m.id !== 'summary')) {
                      continue;
                    }
                    a = _.uniq((function() {
                      var len7, results, w;
                      results = [];
                      for (w = 0, len7 = l.length; w &lt; len7; w++) {
                        i = l[w];
                        if (i[m.id] != null) {
                          results.push(i[m.id]);
                        }
                      }
                      return results;
                    })());
                    switch (a.length) {
                      case 0:
                        d.push(void 0);
                        break;
                      case 1:
                        d.push(disp(m, a[0]));
                        break;
                      default:
                        d.push('\u2043multiple\u2043');
                    }
                  }
              }
            }
          }
          $element.pivotUI(data, opts, opts != null);
          this.active = true;
        };
        pivot.clear = function() {
          this.active = false;
          return $element.empty();
        };
        pivot.get = function() {
          var j, k, len, opts, r, ref;
          if (!this.active) {
            return;
          }
          opts = $element.data('pivotUIOptions');
          r = {};
          ref = ['rendererName', 'cols', 'rows', 'aggregatorName', 'vals'];
          for (j = 0, len = ref.length; j &lt; len; j++) {
            k = ref[j];
            if (k in opts) {
              r[k] = opts[k];
            }
          }
          return r;
        };
        if (typeof pivot.init === "function") {
          pivot.init();
        }
      }
    };
  }
]);

//# sourceMappingURL=pivot.js.map
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Databrary Frontend AngularJS</a></h2><div><h3>Directives</h3><ul><li><a href="module-directive_clickElsewhere.html">directive/clickElsewhere</a></li><li><a href="module-directive_fileModel.html">directive/fileModel</a></li><li><a href="module-directive_focus.html">directive/focus</a></li><li><a href="module-directive_fold.html">directive/fold</a></li><li><a href="module-directive_form.html">directive/form</a></li><li><a href="module-directive_formCtrl.html">directive/formCtrl</a></li><li><a href="module-directive_hint.html">directive/hint</a></li><li><a href="module-directive_homeContainer.html">directive/homeContainer</a></li><li><a href="module-directive_inputDate.html">directive/inputDate</a></li><li><a href="module-directive_inputPosition.html">directive/inputPosition</a></li><li><a href="module-directive_keypress.html">directive/keypress</a></li><li><a href="module-directive_message.html">directive/message</a></li><li><a href="module-directive_mousedrag.html">directive/mousedrag</a></li><li><a href="module-directive_scrollFloat.html">directive/scrollFloat</a></li><li><a href="module-directive_setContents.html">directive/setContents</a></li><li><a href="module-directive_tooltip.html">directive/tooltip</a></li><li><a href="module-directive_validator.html">directive/validator</a></li><li><a href="module-directive_video.html">directive/video</a></li><li><a href="module-party_authApply.html">party/authApply</a></li><li><a href="module-party_authGrant.html">party/authGrant</a></li><li><a href="module-party_authSearch.html">party/authSearch</a></li><li><a href="module-party_comments.html">party/comments</a></li><li><a href="module-party_data.html">party/data</a></li><li><a href="module-party_editAccount.html">party/editAccount</a></li><li><a href="module-party_editApply.html">party/editApply</a></li><li><a href="module-party_editGrant.html">party/editGrant</a></li><li><a href="module-party_editNotifications.html">party/editNotifications</a></li><li><a href="module-party_editProfile.html">party/editProfile</a></li><li><a href="module-party_load.html">party/load</a></li><li><a href="module-party_loginForm.html">party/loginForm</a></li><li><a href="module-party_network.html">party/network</a></li><li><a href="module-party_portrait.html">party/portrait</a></li><li><a href="module-party_userPasswordForm.html">party/userPasswordForm</a></li><li><a href="module-site_activity.html">site/activity</a></li><li><a href="module-site_activityChange.html">site/activityChange</a></li><li><a href="module-site_commentReply.html">site/commentReply</a></li><li><a href="module-site_displayAge.html">site/displayAge</a></li><li><a href="module-site_errors.html">site/errors</a></li><li><a href="module-site_figure.html">site/figure</a></li><li><a href="module-site_frame.html">site/frame</a></li><li><a href="module-site_inputAge.html">site/inputAge</a></li><li><a href="module-site_inputCompleter.html">site/inputCompleter</a></li><li><a href="module-site_notifications.html">site/notifications</a></li><li><a href="module-site_panel.html">site/panel</a></li><li><a href="module-site_searchForm.html">site/searchForm</a></li><li><a href="module-site_tagAdd.html">site/tagAdd</a></li><li><a href="module-site_tags.html">site/tags</a></li><li><a href="module-site_toolbar.html">site/toolbar</a></li><li><a href="module-site_tooltip.html">site/tooltip</a></li><li><a href="module-site_wizard.html">site/wizard</a></li><li><a href="module-site_wizardStep.html">site/wizardStep</a></li><li><a href="module-volume_accessGrant.html">volume/accessGrant</a></li><li><a href="module-volume_accessSearch.html">volume/accessSearch</a></li><li><a href="module-volume_assist.html">volume/assist</a></li><li><a href="module-volume_cite.html">volume/cite</a></li><li><a href="module-volume_comments.html">volume/comments</a></li><li><a href="module-volume_design.html">volume/design</a></li><li><a href="module-volume_editAccess.html">volume/editAccess</a></li><li><a href="module-volume_editFunding.html">volume/editFunding</a></li><li><a href="module-volume_editLinks.html">volume/editLinks</a></li><li><a href="module-volume_editOverview.html">volume/editOverview</a></li><li><a href="module-volume_excerpts.html">volume/excerpts</a></li><li><a href="module-volume_filter.html">volume/filter</a></li><li><a href="module-volume_fundingGrant.html">volume/fundingGrant</a></li><li><a href="module-volume_fundingSearch.html">volume/fundingSearch</a></li><li><a href="module-volume_list.html">volume/list</a></li><li><a href="module-volume_metadata.html">volume/metadata</a></li><li><a href="module-volume_meter.html">volume/meter</a></li><li><a href="module-volume_meterCanvas.html">volume/meterCanvas</a></li><li><a href="module-volume_overview.html">volume/overview</a></li><li><a href="module-volume_owners.html">volume/owners</a></li><li><a href="module-volume_pivot.html">volume/pivot</a></li><li><a href="module-volume_showInvestigators.html">volume/showInvestigators</a></li><li><a href="module-volume_slot.html">volume/slot</a></li><li><a href="module-volume_spreadsheet.html">volume/spreadsheet</a></li></ul></div><div><h3>Services</h3><ul><li><a href="analyticService.html">analyticService</a></li><li><a href="authService.html">authService</a></li><li><a href="constantService.html">constantService</a></li><li><a href="displayService.html">displayService</a></li><li><a href="messageService.html">messageService</a></li><li><a href="modelService.html">modelService</a></li><li><a href="Offset.html">Offset</a></li><li><a href="pageService.html">pageService</a></li><li><a href="play.html">play</a></li><li><a href="routerService.html">routerService</a></li><li><a href="searchService.html">searchService</a></li><li><a href="Segment.html">Segment</a></li><li><a href="storageService.html">storageService</a></li><li><a href="styleService.html">styleService</a></li><li><a href="tooltipService.html">tooltipService</a></li><li><a href="uploadService.html">uploadService</a></li></ul></div><div><h3>Controllers</h3><ul><li><a href="party_activity.html">party/activity</a></li><li><a href="party_edit.html">party/edit</a></li><li><a href="party_login.html">party/login</a></li><li><a href="party_profile.html">party/profile</a></li><li><a href="party_register.html">party/register</a></li><li><a href="party_reset.html">party/reset</a></li><li><a href="party_search.html">party/search</a></li><li><a href="party_view.html">party/view</a></li><li><a href="site_home.html">site/home</a></li><li><a href="site_search.html">site/search</a></li><li><a href="volume_activity.html">volume/activity</a></li><li><a href="volume_csv.html">volume/csv</a></li><li><a href="volume_edit.html">volume/edit</a></li><li><a href="volume_search.html">volume/search</a></li><li><a href="volume_slotActivity.html">volume/slotActivity</a></li><li><a href="volume_view.html">volume/view</a></li><li><a href="volume_zip.html">volume/zip</a></li></ul></div><div><h3>Functions</h3><ul><li><a href="-_anonymous_-link-form.remove.html">remove</a></li><li><a href="-_anonymous_-link-form.save.html">save</a></li><li><a href="-_anonymous_-pre-checkDirty.html">checkDirty</a></li><li><a href="-_anonymous_-pre-form.$setUnsubmitted.html">$setUnsubmitted</a></li><li><a href="-_anonymous_-pre-form.resetAll.html">resetAll</a></li><li><a href="module-volume_accessSearch-form.search.html">search</a></li></ul></div>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Fri May 18 2018 14:34:35 GMT-0400 (EDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
