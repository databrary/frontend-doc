<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Frontend Documentation</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: service/segment.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Make the calls when party or volume is searched
 * @namespace Segment
 */

'use strict';

app.factory('Segment', [
  'constantService', 'Offset',
  function (constants, Offset) {
    function Segment() {
      this.init.apply(this, arguments);
    }

    Segment.prototype.init = function(a, u) {
      var l;
      if (arguments.length >= 2) {
        l = a;
      } else if (arguments.length &lt; 1 || a === null || a === '') {
        l = Infinity;
        u = -Infinity;
      } else if (a === undefined) {
        l = -Infinity;
        u = Infinity;
      } else if (Array.isArray(a)) {
        l = typeof a[0] === 'number' ? a[0] : -Infinity;
        u = typeof a[1] === 'number' ? a[1] : Infinity;
      } else if (typeof a === 'number') {
        l = u = a;
      } else if (typeof a === 'object' &amp;&amp; 'l' in a &amp;&amp; 'u' in a) {
        l = a.l;
        u = a.u;
      } else if (typeof a === 'string') {
        /* this is not a full parser as the backend has, but just needs to be sufficient to parse the output of .format */
        var i = a.indexOf(',');
        if (i === -1) {
          i = a.indexOf('-', 1);
          if (i === -1) {
            this.l = this.u = Math.round(Offset.parse(a));
            return;
          }
        }
        l = i === 0 ? -Infinity : Offset.parse(a.substr(0,i));
        u = i === a.length-1 ? Infinity : Offset.parse(a.substr(i+1));
      } else
        throw new Error('invalid Segment construction');
      this.l = Math.round(l);
      this.u = Math.round(u);
    };

    Object.defineProperties(Segment.prototype, {
      full: {
        get: function () {
          return this.l === -Infinity &amp;&amp; this.u === Infinity;
        }
      },
      empty: {
        get: function () {
          return this.l > this.u;
        }
      },
      length: {
        get: function () {
          return this.u >= this.l ? this.u - this.l : undefined;
        }
      },
      lBounded: {
        get: function () {
          return this.l &lt;= this.u &amp;&amp; isFinite(this.l);
        }
      },
      uBounded: {
        get: function () {
          return this.u >= this.l &amp;&amp; isFinite(this.u);
        }
      },
      base: {
        get: function () {
          return isFinite(this.l) ? this.l : 0;
        }
      }
    });

    Segment.isFull = function (x) {
      return x === undefined ||
        (x instanceof Segment &amp;&amp; x.full) ||
        x === ',' || x === '-'; // handle strings just as an optimization
    };
    Segment.full = constants.deepFreeze(new Segment(undefined));

    Segment.isEmpty = function (x) {
      return x === null ||
        (x instanceof Segment &amp;&amp; x.empty) ||
        x === '';
    };
    Segment.empty = constants.deepFreeze(new Segment(null));

    function base(x) {
      if (x instanceof Segment)
        return x.base;
      if (Array.isArray(x))
        x = x[0];
      return isFinite(x) ? x : 0;
    }

    Segment.make = function(x) {
      return x instanceof Segment ? x : new Segment(x);
    };

    Segment.prototype.format = function () {
      if (this.full)
        return '-';
      if (this.empty)
        return '';
      var l = Math.floor(this.l);
      var u = Math.floor(this.u);
      if (l === u)
        return l.toString();
      return (isFinite(l) ? l : '') +
        ',' + (isFinite(u) ? u : '');
    };

    Segment.prototype.toString = Segment.prototype.format;

    Segment.prototype.equals = function (that) {
      if (Segment.isFull(that))
        return this.full;
      if (Segment.isEmpty(that))
        return this.empty;
      if (typeof that === 'string')
        return false;
      that = Segment.make(that);
      return this.l === that.l &amp;&amp; this.u === that.u;
    };

    Segment.prototype.intersect = function (that) {
      if (this.empty || Segment.isFull(that))
        return this;
      if (this.full || Segment.isEmpty(that))
        return that;
      that = Segment.make(that);
      var r = new Segment(
          Math.max(this.l, that.l),
          Math.min(this.u, that.u));
      // fix ,y) &amp;&amp; [y, => [y,y]
      if (this.l &lt; this.u &amp;&amp; this.u &lt;= r.l || that.l &lt; that.u &amp;&amp; that.u &lt;= r.l)
        return Segment.empty;
      return r;
    };

    /* If segments are disjoint, assume the excluded middle. */
    Segment.prototype.union = function (that) {
      if (this.empty || Segment.isFull(that))
        return that;
      if (this.full || Segment.isEmpty(that))
        return this;
      that = Segment.make(that);
      return new Segment(
          Math.min(this.l, that.l),
          Math.max(this.u, that.u));
    };

    Segment.prototype.overlaps = function (that) {
      return !this.intersect(that).empty;
    };

    Segment.prototype.contains = function (that) {
      if (typeof that === 'number')
        return that >= this.l &amp;&amp; (that &lt; this.u || that === this.u &amp;&amp; this.l === this.u);
      if (Segment.isFull(that))
        return this.full;
      if (Segment.isEmpty(that))
        return !this.empty;
      that = Segment.make(that);
      if (that.l === that.u)
        return this.contains(that.l);
      return this.l &lt;= that.l &amp;&amp; this.u >= that.u;
    };

    Segment.prototype.shift = function (s) {
      return new Segment(this.l + s, this.u + s);
    };

    Segment.prototype.relativeTo = function (b) {
      return this.shift(-base(b));
    };

    Segment.format = function (seg) {
      if (Segment.isFull(seg))
        return '-';
      if (Segment.isEmpty(seg))
        return 'empty';
      return seg.toString();
    };

    Segment.data = function (seg) {
      if (seg instanceof Object &amp;&amp; !(seg instanceof Segment) &amp;&amp; !Array.isArray(seg))
        return seg;
      return Segment.format(seg);
    };

    return Segment;
  }
]);
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Databrary Frontend AngularJS</a></h2><div><h3>Directives</h3><ul><li><a href="module-directive_clickElsewhere.html">directive/clickElsewhere</a></li><li><a href="module-directive_fileModel.html">directive/fileModel</a></li><li><a href="module-directive_focus.html">directive/focus</a></li><li><a href="module-directive_fold.html">directive/fold</a></li><li><a href="module-directive_form.html">directive/form</a></li><li><a href="module-directive_formCtrl.html">directive/formCtrl</a></li><li><a href="module-directive_hint.html">directive/hint</a></li><li><a href="module-directive_homeContainer.html">directive/homeContainer</a></li><li><a href="module-directive_inputDate.html">directive/inputDate</a></li><li><a href="module-directive_inputPosition.html">directive/inputPosition</a></li><li><a href="module-directive_keypress.html">directive/keypress</a></li><li><a href="module-directive_message.html">directive/message</a></li><li><a href="module-directive_mousedrag.html">directive/mousedrag</a></li><li><a href="module-directive_scrollFloat.html">directive/scrollFloat</a></li><li><a href="module-directive_setContents.html">directive/setContents</a></li><li><a href="module-directive_tooltip.html">directive/tooltip</a></li><li><a href="module-directive_validator.html">directive/validator</a></li><li><a href="module-directive_video.html">directive/video</a></li><li><a href="module-party_authApply.html">party/authApply</a></li><li><a href="module-party_authGrant.html">party/authGrant</a></li><li><a href="module-party_authSearch.html">party/authSearch</a></li><li><a href="module-party_comments.html">party/comments</a></li><li><a href="module-party_data.html">party/data</a></li><li><a href="module-party_editAccount.html">party/editAccount</a></li><li><a href="module-party_editApply.html">party/editApply</a></li><li><a href="module-party_editGrant.html">party/editGrant</a></li><li><a href="module-party_editNotifications.html">party/editNotifications</a></li><li><a href="module-party_editProfile.html">party/editProfile</a></li><li><a href="module-party_load.html">party/load</a></li><li><a href="module-party_loginForm.html">party/loginForm</a></li><li><a href="module-party_network.html">party/network</a></li><li><a href="module-party_portrait.html">party/portrait</a></li><li><a href="module-party_userPasswordForm.html">party/userPasswordForm</a></li><li><a href="module-site_activity.html">site/activity</a></li><li><a href="module-site_activityChange.html">site/activityChange</a></li><li><a href="module-site_commentReply.html">site/commentReply</a></li><li><a href="module-site_displayAge.html">site/displayAge</a></li><li><a href="module-site_errors.html">site/errors</a></li><li><a href="module-site_figure.html">site/figure</a></li><li><a href="module-site_frame.html">site/frame</a></li><li><a href="module-site_inputAge.html">site/inputAge</a></li><li><a href="module-site_inputCompleter.html">site/inputCompleter</a></li><li><a href="module-site_notifications.html">site/notifications</a></li><li><a href="module-site_panel.html">site/panel</a></li><li><a href="module-site_searchForm.html">site/searchForm</a></li><li><a href="module-site_tagAdd.html">site/tagAdd</a></li><li><a href="module-site_tags.html">site/tags</a></li><li><a href="module-site_toolbar.html">site/toolbar</a></li><li><a href="module-site_tooltip.html">site/tooltip</a></li><li><a href="module-site_wizard.html">site/wizard</a></li><li><a href="module-site_wizardStep.html">site/wizardStep</a></li><li><a href="module-volume_accessGrant.html">volume/accessGrant</a></li><li><a href="module-volume_accessSearch.html">volume/accessSearch</a></li><li><a href="module-volume_assist.html">volume/assist</a></li><li><a href="module-volume_cite.html">volume/cite</a></li><li><a href="module-volume_comments.html">volume/comments</a></li><li><a href="module-volume_design.html">volume/design</a></li><li><a href="module-volume_editAccess.html">volume/editAccess</a></li><li><a href="module-volume_editFunding.html">volume/editFunding</a></li><li><a href="module-volume_editLinks.html">volume/editLinks</a></li><li><a href="module-volume_editOverview.html">volume/editOverview</a></li><li><a href="module-volume_excerpts.html">volume/excerpts</a></li><li><a href="module-volume_filter.html">volume/filter</a></li><li><a href="module-volume_fundingGrant.html">volume/fundingGrant</a></li><li><a href="module-volume_fundingSearch.html">volume/fundingSearch</a></li><li><a href="module-volume_list.html">volume/list</a></li><li><a href="module-volume_metadata.html">volume/metadata</a></li><li><a href="module-volume_meter.html">volume/meter</a></li><li><a href="module-volume_meterCanvas.html">volume/meterCanvas</a></li><li><a href="module-volume_overview.html">volume/overview</a></li><li><a href="module-volume_owners.html">volume/owners</a></li><li><a href="module-volume_pivot.html">volume/pivot</a></li><li><a href="module-volume_showInvestigators.html">volume/showInvestigators</a></li><li><a href="module-volume_slot.html">volume/slot</a></li><li><a href="module-volume_spreadsheet.html">volume/spreadsheet</a></li></ul></div><div><h3>Services</h3><ul><li><a href="analyticService.html">analyticService</a></li><li><a href="authService.html">authService</a></li><li><a href="constantService.html">constantService</a></li><li><a href="displayService.html">displayService</a></li><li><a href="messageService.html">messageService</a></li><li><a href="modelService.html">modelService</a></li><li><a href="Offset.html">Offset</a></li><li><a href="pageService.html">pageService</a></li><li><a href="play.html">play</a></li><li><a href="routerService.html">routerService</a></li><li><a href="searchService.html">searchService</a></li><li><a href="Segment.html">Segment</a></li><li><a href="storageService.html">storageService</a></li><li><a href="styleService.html">styleService</a></li><li><a href="tooltipService.html">tooltipService</a></li><li><a href="uploadService.html">uploadService</a></li></ul></div><div><h3>Controllers</h3><ul><li><a href="party_activity.html">party/activity</a></li><li><a href="party_edit.html">party/edit</a></li><li><a href="party_login.html">party/login</a></li><li><a href="party_profile.html">party/profile</a></li><li><a href="party_register.html">party/register</a></li><li><a href="party_reset.html">party/reset</a></li><li><a href="party_search.html">party/search</a></li><li><a href="party_view.html">party/view</a></li><li><a href="site_home.html">site/home</a></li><li><a href="site_search.html">site/search</a></li><li><a href="volume_activity.html">volume/activity</a></li><li><a href="volume_csv.html">volume/csv</a></li><li><a href="volume_edit.html">volume/edit</a></li><li><a href="volume_search.html">volume/search</a></li><li><a href="volume_slotActivity.html">volume/slotActivity</a></li><li><a href="volume_view.html">volume/view</a></li><li><a href="volume_zip.html">volume/zip</a></li></ul></div><div><h3>Functions</h3><ul><li><a href="modelService_Asset.html">modelService/Asset</a></li><li><a href="modelService_checkOptions.html">modelService/checkOptions</a></li><li><a href="modelService_delegate.html">modelService/delegate</a></li><li><a href="modelService_Login.html">modelService/Login</a></li><li><a href="modelService_Login_checkPermission.html">modelService/Login/checkPermission</a></li><li><a href="modelService_Login_isLoggedIn.html">modelService/Login/isLoggedIn</a></li><li><a href="modelService_Login_register.html">modelService/Login/register</a></li><li><a href="modelService_Login_saveAccount.html">modelService/Login/saveAccount</a></li><li><a href="modelService_Party_authorizeApply.html">modelService/Party/authorizeApply</a></li><li><a href="modelService_Party_authorizeSave.html">modelService/Party/authorizeSave</a></li><li><a href="modelService_Party_get.html">modelService/Party/get</a></li><li><a href="modelService_Party_getActivity.html">modelService/Party/getActivity</a></li><li><a href="modelService_Party_init.html">modelService/Party/init</a></li><li><a href="modelService_Party_save.html">modelService/Party/save</a></li><li><a href="modelService_Party_search.html">modelService/Party/search</a></li><li><a href="modelService_Record.html">modelService/Record</a></li><li><a href="modelService_Slot.html">modelService/Slot</a></li><li><a href="modelService_Volume_init.html">modelService/Volume/init</a></li><li><a href="module-directive_form-form_$setUnsubmitted.html">form/$setUnsubmitted</a></li><li><a href="module-directive_form-form_checkDirty.html">form/checkDirty</a></li><li><a href="module-directive_form-form_resetAll.html">form/resetAll</a></li><li><a href="module-volume_accessGrant-form_remove.html">form/remove</a></li><li><a href="module-volume_accessGrant-form_save.html">form/save</a></li><li><a href="module-volume_accessSearch-form_search.html">form/search</a></li><li><a href="module-volume_overview-volume_generateReleasesummary.html">volume/generateReleasesummary</a></li><li><a href="module-volume_overview-volume_generateSummary.html">volume/generateSummary</a></li><li><a href="module-volume_slot-slot_Asset.html">slot/Asset</a></li><li><a href="module-volume_slot-slot_Comment.html">slot/Comment</a></li><li><a href="module-volume_slot-slot_Excerpt.html">slot/Excerpt</a></li><li><a href="module-volume_slot-slot_Record.html">slot/Record</a></li><li><a href="module-volume_slot-slot_searchLocation.html">slot/searchLocation</a></li><li><a href="module-volume_slot-slot_setPlayerHeight.html">slot/setPlayerHeight</a></li><li><a href="module-volume_slot-slot_setSelectionEnd.html">slot/setSelectionEnd</a></li><li><a href="module-volume_slot-slot_Tag.html">slot/Tag</a></li><li><a href="module-volume_slot-slot_TagName.html">slot/TagName</a></li><li><a href="module-volume_slot-slot_TimeBar.html">slot/TimeBar</a></li><li><a href="module-volume_slot-slot_TimeBar_snapping.html">slot/TimeBar/snapping</a></li><li><a href="module-volume_slot-slot_TimePoint.html">slot/TimePoint</a></li><li><a href="module-volume_slot-slot_TimeSegment.html">slot/TimeSegment</a></li><li><a href="module-volume_slot-slot_updatePosition.html">slot/updatePosition</a></li><li><a href="module-volume_spreadsheet-spreadsheet_collapse.html">spreadsheet/collapse</a></li><li><a href="module-volume_spreadsheet-spreadsheet_expand.html">spreadsheet/expand</a></li><li><a href="module-volume_spreadsheet-spreadsheet_fill.html">spreadsheet/fill</a></li><li><a href="module-volume_spreadsheet-spreadsheet_generateRecord.html">spreadsheet/generateRecord</a></li><li><a href="module-volume_spreadsheet-spreadsheet_generateRow.html">spreadsheet/generateRow</a></li><li><a href="module-volume_spreadsheet-spreadsheet_generateText.html">spreadsheet/generateText</a></li><li><a href="module-volume_spreadsheet-spreadsheet_Info.html">spreadsheet/Info</a></li><li><a href="module-volume_spreadsheet-spreadsheet_populateCols.html">spreadsheet/populateCols</a></li><li><a href="module-volume_spreadsheet-spreadsheet_populateSlot.html">spreadsheet/populateSlot</a></li><li><a href="module-volume_spreadsheet-spreadsheet_Row.html">spreadsheet/Row</a></li><li><a href="module-volume_spreadsheet-spreadsheet_saveRun.html">spreadsheet/saveRun</a></li><li><a href="module-volume_spreadsheet-spreadsheet_setKey.html">spreadsheet/setKey</a></li><li><a href="module-volume_spreadsheet-spreadsheet_sort.html">spreadsheet/sort</a></li><li><a href="module-volume_spreadsheet-spreadsheet_sortBy.html">spreadsheet/sortBy</a></li><li><a href="profile_Party.html">profile/Party</a></li><li><a href="profile_sortVolumes.html">profile/sortVolumes</a></li><li><a href="profile_Volume.html">profile/Volume</a></li></ul></div>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Wed May 30 2018 14:02:16 GMT-0400 (EDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
